generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Evaluator {
  id              Int           @id @default(autoincrement())
  name            String        @db.VarChar(255)
  evaluatorTypeId Int
  points          String        @db.VarChar(255)
  leagueId        Int
  entity          String        @default("match") @db.VarChar(255)
  createdAt       DateTime      @db.Timestamptz(6)
  updatedAt       DateTime      @db.Timestamptz(6)
  deletedAt       DateTime?     @db.Timestamptz(6)
  EvaluatorType   EvaluatorType @relation(fields: [evaluatorTypeId], references: [id], onDelete: NoAction)
  League          League        @relation(fields: [leagueId], references: [id], onDelete: NoAction)
}

model EvaluatorType {
  id        Int         @id @default(autoincrement())
  name      String      @db.VarChar(255)
  createdAt DateTime    @db.Timestamptz(6)
  updatedAt DateTime    @db.Timestamptz(6)
  deletedAt DateTime?   @db.Timestamptz(6)
  Evaluator Evaluator[]
}

model League {
  id                     Int                      @id @default(autoincrement())
  name                   String                   @db.VarChar(255)
  sportId                Int
  isActive               Boolean                  @default(false)
  isTheMostActive        Boolean?                 @default(false)
  seasonFrom             Int
  seasonTo               Int
  isFinished             Boolean?                 @default(false)
  isPublic               Boolean                  @default(false)
  createdAt              DateTime                 @db.Timestamptz(6)
  updatedAt              DateTime                 @db.Timestamptz(6)
  deletedAt              DateTime?                @db.Timestamptz(6)
  Evaluator              Evaluator[]
  Sport                  Sport                    @relation(fields: [sportId], references: [id], onDelete: NoAction)
  LeagueMatch            LeagueMatch[]
  LeagueSpecialBetSerie  LeagueSpecialBetSerie[]
  LeagueSpecialBetSingle LeagueSpecialBetSingle[]
  LeagueTeam             LeagueTeam[]
  LeagueUser             LeagueUser[]
  UserRequest            UserRequest[]
  UserSetting            UserSetting[]
}

model LeagueMatch {
  id        Int       @id @default(autoincrement())
  leagueId  Int
  matchId   Int
  isDoubled Boolean?
  createdAt DateTime  @db.Timestamptz(6)
  updatedAt DateTime  @db.Timestamptz(6)
  deletedAt DateTime? @db.Timestamptz(6)
  League    League    @relation(fields: [leagueId], references: [id], onDelete: NoAction)
  Match     Match     @relation(fields: [matchId], references: [id], onDelete: NoAction)
  UserBet   UserBet[]
}

model LeaguePhase {
  id         Int          @id @default(autoincrement())
  name       String       @db.VarChar(255)
  rank       Int          @default(0)
  createdAt  DateTime     @db.Timestamptz(6)
  updatedAt  DateTime     @db.Timestamptz(6)
  deletedAt  DateTime?    @db.Timestamptz(6)
  LeagueTeam LeagueTeam[]
}

model LeaguePlayer {
  id                     Int                      @id @default(autoincrement())
  leagueTeamId           Int
  playerId               Int
  seasonGames            Int?
  seasonGoals            Int?
  seasonAssists          Int?
  clubName               String?                  @db.VarChar(255)
  createdAt              DateTime                 @db.Timestamptz(6)
  updatedAt              DateTime                 @db.Timestamptz(6)
  deletedAt              DateTime?                @db.Timestamptz(6)
  playoffGames           Int?
  playoffGoals           Int?
  playoffAssists         Int?
  topScorerRanking       Int?
  LeagueTeam             LeagueTeam               @relation(fields: [leagueTeamId], references: [id], onDelete: NoAction)
  Player                 Player                   @relation(fields: [playerId], references: [id], onDelete: NoAction)
  LeagueSpecialBetSingle LeagueSpecialBetSingle[]
  MatchScorer            MatchScorer[]
  UserBet                UserBet[]
  UserSpecialBetSingle   UserSpecialBetSingle[]
}

model LeagueSpecialBetSerie {
  id                                                      Int                   @id @default(autoincrement())
  leagueId                                                Int
  specialBetSerieId                                       Int
  dateTime                                                DateTime              @db.Timestamptz(6)
  homeTeamId                                              Int
  awayTeamId                                              Int
  homeTeamScore                                           Int?
  awayTeamScore                                           Int?
  isEvaluated                                             Boolean               @default(false)
  createdAt                                               DateTime              @db.Timestamptz(6)
  updatedAt                                               DateTime              @db.Timestamptz(6)
  deletedAt                                               DateTime?             @db.Timestamptz(6)
  LeagueTeam_LeagueSpecialBetSerie_awayTeamIdToLeagueTeam LeagueTeam            @relation("LeagueSpecialBetSerie_awayTeamIdToLeagueTeam", fields: [awayTeamId], references: [id], onDelete: NoAction)
  LeagueTeam_LeagueSpecialBetSerie_homeTeamIdToLeagueTeam LeagueTeam            @relation("LeagueSpecialBetSerie_homeTeamIdToLeagueTeam", fields: [homeTeamId], references: [id], onDelete: NoAction)
  League                                                  League                @relation(fields: [leagueId], references: [id], onDelete: NoAction)
  SpecialBetSerie                                         SpecialBetSerie       @relation(fields: [specialBetSerieId], references: [id], onDelete: NoAction)
  UserSpecialBetSerie                                     UserSpecialBetSerie[]
}

model LeagueSpecialBetSingle {
  id                       Int                    @id @default(autoincrement())
  leagueId                 Int
  specialBetSingleId       Int
  specialBetTeamResultId   Int?
  specialBetPlayerResultId Int?
  specialBetValue          Int?
  points                   Int
  dateTime                 DateTime               @db.Timestamptz(6)
  isEvaluated              Boolean                @default(false)
  createdAt                DateTime               @db.Timestamptz(6)
  updatedAt                DateTime               @db.Timestamptz(6)
  deletedAt                DateTime?              @db.Timestamptz(6)
  League                   League                 @relation(fields: [leagueId], references: [id], onDelete: NoAction)
  LeaguePlayer             LeaguePlayer?          @relation(fields: [specialBetPlayerResultId], references: [id])
  SpecialBetSingle         SpecialBetSingle       @relation(fields: [specialBetSingleId], references: [id], onDelete: NoAction)
  LeagueTeam               LeagueTeam?            @relation(fields: [specialBetTeamResultId], references: [id])
  UserSpecialBetSingle     UserSpecialBetSingle[]
}

model LeagueTeam {
  id                                                                 Int                      @id @default(autoincrement())
  leagueId                                                           Int
  teamId                                                             Int
  group                                                              String?                  @db.VarChar(255)
  leaguePhaseAchievedId                                              Int?
  createdAt                                                          DateTime                 @db.Timestamptz(6)
  updatedAt                                                          DateTime                 @db.Timestamptz(6)
  deletedAt                                                          DateTime?                @db.Timestamptz(6)
  LeaguePlayer                                                       LeaguePlayer[]
  LeagueSpecialBetSerie_LeagueSpecialBetSerie_awayTeamIdToLeagueTeam LeagueSpecialBetSerie[]  @relation("LeagueSpecialBetSerie_awayTeamIdToLeagueTeam")
  LeagueSpecialBetSerie_LeagueSpecialBetSerie_homeTeamIdToLeagueTeam LeagueSpecialBetSerie[]  @relation("LeagueSpecialBetSerie_homeTeamIdToLeagueTeam")
  LeagueSpecialBetSingle                                             LeagueSpecialBetSingle[]
  League                                                             League                   @relation(fields: [leagueId], references: [id], onDelete: NoAction)
  LeaguePhase                                                        LeaguePhase?             @relation(fields: [leaguePhaseAchievedId], references: [id], onDelete: NoAction)
  Team                                                               Team                     @relation(fields: [teamId], references: [id], onDelete: NoAction)
  Match_Match_awayTeamIdToLeagueTeam                                 Match[]                  @relation("Match_awayTeamIdToLeagueTeam")
  Match_Match_homeTeamIdToLeagueTeam                                 Match[]                  @relation("Match_homeTeamIdToLeagueTeam")
  UserSpecialBetSingle                                               UserSpecialBetSingle[]
}

model LeagueUser {
  id                   Int                    @id @default(autoincrement())
  leagueId             Int
  userId               Int
  paid                 Boolean                @default(false)
  active               Boolean?               @default(true)
  admin                Boolean?               @default(false)
  createdAt            DateTime               @db.Timestamptz(6)
  updatedAt            DateTime               @db.Timestamptz(6)
  deletedAt            DateTime?              @db.Timestamptz(6)
  League               League                 @relation(fields: [leagueId], references: [id], onDelete: NoAction)
  User                 User                   @relation(fields: [userId], references: [id], onDelete: NoAction)
  UserBet              UserBet[]
  UserSetting          UserSetting[]
  UserSpecialBetSerie  UserSpecialBetSerie[]
  UserSpecialBetSingle UserSpecialBetSingle[]
}

model Match {
  id                                      Int           @id @default(autoincrement())
  gameNumber                              Int?
  dateTime                                DateTime      @db.Timestamptz(6)
  homeTeamId                              Int
  awayTeamId                              Int
  homeRegularScore                        Int?
  awayRegularScore                        Int?
  homeFinalScore                          Int?
  awayFinalScore                          Int?
  isOvertime                              Boolean?
  isShootout                              Boolean?
  isEvaluated                             Boolean       @default(false)
  isPlayoffGame                           Boolean       @default(false)
  externalId                              Int?
  createdAt                               DateTime      @db.Timestamptz(6)
  updatedAt                               DateTime      @db.Timestamptz(6)
  deletedAt                               DateTime?     @db.Timestamptz(6)
  LeagueMatch                             LeagueMatch[]
  LeagueTeam_Match_awayTeamIdToLeagueTeam LeagueTeam    @relation("Match_awayTeamIdToLeagueTeam", fields: [awayTeamId], references: [id], onDelete: NoAction)
  LeagueTeam_Match_homeTeamIdToLeagueTeam LeagueTeam    @relation("Match_homeTeamIdToLeagueTeam", fields: [homeTeamId], references: [id], onDelete: NoAction)
  MatchScorer                             MatchScorer[]
}

model MatchScorer {
  id            Int          @id @default(autoincrement())
  matchId       Int
  scorerId      Int
  numberOfGoals Int
  createdAt     DateTime     @db.Timestamptz(6)
  updatedAt     DateTime     @db.Timestamptz(6)
  deletedAt     DateTime?    @db.Timestamptz(6)
  Match         Match        @relation(fields: [matchId], references: [id], onDelete: NoAction)
  LeaguePlayer  LeaguePlayer @relation(fields: [scorerId], references: [id], onDelete: NoAction)
}

model Player {
  id           Int            @id @default(autoincrement())
  firstName    String?        @db.VarChar(255)
  lastName     String?
  isActive     Boolean        @default(true)
  position     String?        @db.VarChar(255)
  externalId   Int?
  createdAt    DateTime       @db.Timestamptz(6)
  updatedAt    DateTime       @db.Timestamptz(6)
  deletedAt    DateTime?      @db.Timestamptz(6)
  LeaguePlayer LeaguePlayer[]
}

model SequelizeMeta {
  name String @id @db.VarChar(255)
}

model SpecialBetSerie {
  id                    Int                     @id @default(autoincrement())
  bestOf                Int
  name                  String                  @db.VarChar(255)
  createdAt             DateTime                @db.Timestamptz(6)
  updatedAt             DateTime                @db.Timestamptz(6)
  deletedAt             DateTime?               @db.Timestamptz(6)
  LeagueSpecialBetSerie LeagueSpecialBetSerie[]
}

model SpecialBetSingle {
  id                     Int                      @id @default(autoincrement())
  sportId                Int
  specialBetSingleTypeId Int
  name                   String                   @db.VarChar(255)
  createdAt              DateTime                 @db.Timestamptz(6)
  updatedAt              DateTime                 @db.Timestamptz(6)
  deletedAt              DateTime?                @db.Timestamptz(6)
  LeagueSpecialBetSingle LeagueSpecialBetSingle[]
  SpecialBetSingleType   SpecialBetSingleType     @relation(fields: [specialBetSingleTypeId], references: [id], onDelete: NoAction)
  Sport                  Sport                    @relation(fields: [sportId], references: [id], onDelete: NoAction)
}

model SpecialBetSingleType {
  id               Int                @id @default(autoincrement())
  name             String             @db.VarChar(255)
  createdAt        DateTime           @db.Timestamptz(6)
  updatedAt        DateTime           @db.Timestamptz(6)
  deletedAt        DateTime?          @db.Timestamptz(6)
  SpecialBetSingle SpecialBetSingle[]
}

model Sport {
  id               Int                @id @default(autoincrement())
  name             String             @db.VarChar(255)
  createdAt        DateTime           @db.Timestamptz(6)
  updatedAt        DateTime           @db.Timestamptz(6)
  deletedAt        DateTime?          @db.Timestamptz(6)
  League           League[]
  SpecialBetSingle SpecialBetSingle[]
  Team             Team[]
}

model Team {
  id         Int          @id @default(autoincrement())
  name       String       @db.VarChar(255)
  nickname   String?      @db.VarChar(255)
  shortcut   String       @db.VarChar(255)
  flagIcon   String?      @db.VarChar(255)
  flagType   String?      @db.VarChar(50)
  sportId    Int
  externalId Int?
  createdAt  DateTime     @db.Timestamptz(6)
  updatedAt  DateTime     @db.Timestamptz(6)
  deletedAt  DateTime?    @db.Timestamptz(6)
  LeagueTeam LeagueTeam[]
  Sport      Sport        @relation(fields: [sportId], references: [id], onDelete: NoAction)
}

model User {
  id                  Int                   @id @default(autoincrement())
  firstName           String                @db.VarChar(255)
  lastName            String                @db.VarChar(255)
  username            String                @db.VarChar(255)
  email               String                @unique @db.VarChar(255)
  mobileNumber        String?               @db.VarChar(255)
  password            String                @db.VarChar(255)
  salt                String?               @db.VarChar(255)
  pushId              String?               @db.VarChar(255)
  isSuperadmin        Boolean               @default(false)
  createdAt           DateTime              @db.Timestamptz(6)
  updatedAt           DateTime              @db.Timestamptz(6)
  deletedAt           DateTime?             @db.Timestamptz(6)
  notifyHours         Int                   @default(2)
  LeagueUser          LeagueUser[]
  UserRequest         UserRequest[]
  PasswordResetToken  PasswordResetToken[]
}

model PasswordResetToken {
  id        Int       @id @default(autoincrement())
  userId    Int
  token     String    @unique @db.VarChar(255)
  expiresAt DateTime  @db.Timestamptz(6)
  createdAt DateTime  @db.Timestamptz(6)
  usedAt    DateTime? @db.Timestamptz(6)

  User User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([userId, expiresAt])
}

model UserBet {
  id            Int           @id @default(autoincrement())
  leagueMatchId Int
  leagueUserId  Int
  dateTime      DateTime      @db.Timestamptz(6)
  homeScore     Int           @default(0)
  awayScore     Int           @default(0)
  homeAdvanced  Boolean?
  scorerId      Int?
  totalPoints   Int           @default(0)
  overtime      Boolean       @default(false)
  createdAt     DateTime      @db.Timestamptz(6)
  updatedAt     DateTime      @db.Timestamptz(6)
  deletedAt     DateTime?     @db.Timestamptz(6)
  LeagueMatch   LeagueMatch   @relation(fields: [leagueMatchId], references: [id], onDelete: NoAction)
  LeagueUser    LeagueUser    @relation(fields: [leagueUserId], references: [id], onDelete: Cascade)
  LeaguePlayer  LeaguePlayer? @relation(fields: [scorerId], references: [id])
}

model UserRequest {
  id        Int       @id @default(autoincrement())
  userId    Int
  leagueId  Int
  decided   Boolean   @default(false)
  accepted  Boolean   @default(false)
  createdAt DateTime  @db.Timestamptz(6)
  updatedAt DateTime  @db.Timestamptz(6)
  deletedAt DateTime? @db.Timestamptz(6)
  League    League    @relation(fields: [leagueId], references: [id], onDelete: NoAction)
  User      User      @relation(fields: [userId], references: [id], onDelete: NoAction)
}

model UserSetting {
  id                            Int        @id @default(autoincrement())
  leagueUserId                  Int
  leagueId                      Int
  emailBetNotification          Boolean?   @default(false)
  emailBetNotificationValue     Int?       @default(0)
  emailRankingNotification      Boolean?   @default(false)
  emailRankingNotificationValue Int?       @default(0)
  createdAt                     DateTime   @db.Timestamptz(6)
  updatedAt                     DateTime   @db.Timestamptz(6)
  deletedAt                     DateTime?  @db.Timestamptz(6)
  League                        League     @relation(fields: [leagueId], references: [id], onDelete: NoAction)
  LeagueUser                    LeagueUser @relation(fields: [leagueUserId], references: [id], onDelete: NoAction)
}

model UserSpecialBetSerie {
  id                      Int                   @id @default(autoincrement())
  leagueSpecialBetSerieId Int
  leagueUserId            Int
  homeTeamScore           Int?
  awayTeamScore           Int?
  totalPoints             Int                   @default(0)
  dateTime                DateTime              @db.Timestamptz(6)
  createdAt               DateTime              @db.Timestamptz(6)
  updatedAt               DateTime              @db.Timestamptz(6)
  deletedAt               DateTime?             @db.Timestamptz(6)
  LeagueSpecialBetSerie   LeagueSpecialBetSerie @relation(fields: [leagueSpecialBetSerieId], references: [id], onDelete: NoAction)
  LeagueUser              LeagueUser            @relation(fields: [leagueUserId], references: [id], onDelete: NoAction)
}

model UserSpecialBetSingle {
  id                       Int                    @id @default(autoincrement())
  leagueSpecialBetSingleId Int
  leagueUserId             Int
  teamResultId             Int?
  playerResultId           Int?
  value                    Int?
  totalPoints              Int                    @default(0)
  dateTime                 DateTime               @db.Timestamptz(6)
  createdAt                DateTime               @db.Timestamptz(6)
  updatedAt                DateTime               @db.Timestamptz(6)
  deletedAt                DateTime?              @db.Timestamptz(6)
  LeagueSpecialBetSingle   LeagueSpecialBetSingle @relation(fields: [leagueSpecialBetSingleId], references: [id], onDelete: NoAction)
  LeagueUser               LeagueUser             @relation(fields: [leagueUserId], references: [id], onDelete: NoAction)
  LeaguePlayer             LeaguePlayer?          @relation(fields: [playerResultId], references: [id])
  LeagueTeam               LeagueTeam?            @relation(fields: [teamResultId], references: [id])
}
